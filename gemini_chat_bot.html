<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø³ÙŠØ§Ø­ÙŠ Ø§Ù„Ù…ÙˆØ³Ø¹ - ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§</title>
<style>
:root {
    --blue-royal: #004080;
    --gold: #ffc107;
    --white: #e0e0e0;
    --card-bg: #1f1f1f;
    --dark-bg: #121212;
    --input-bg: #222;
}

body {
    margin: 0;
    background-color: var(--dark-bg);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: var(--white);
}

.chat-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 800px;
    width: 100%;
    margin: 0 auto;
    background-color: #1a1a1a;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

.chat-header {
    background-color: var(--blue-royal);
    color: var(--white);
    padding: 15px;
    text-align: center;
    font-size: 1.3em;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

#exitButton {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    font-size: 1.5em;
    color: var(--white);
    cursor: pointer;
}
.chat-messages {
    flex-grow: 0;          /* Ù…Ù†Ø¹ Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ */
    height: 65vh;          /* Ø­Ø¬Ù… Ø«Ø§Ø¨Øª Ù†Ø³Ø¨ÙŠ Ù„Ù„Ø´Ø§Ø´Ø© (ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨Ø©) */
    padding: 15px;
    overflow-y: auto;      /* Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù…ØªÙ„Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    background-color: #1e1e1e;
    border-radius: 0 0 10px 10px; /* Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ø¬Ù…Ø§Ù„ Ø§Ù„ØªØµÙ…ÙŠÙ… */
}

.message {
    max-width: 85%;
    margin-bottom: 12px;
    padding: 12px 18px;
    border-radius: 18px;
    word-wrap: break-word;
    position: relative;
    line-height: 1.5;
}

.user-message {
    background-color: var(--gold);
    color: var(--dark-bg);
    align-self: flex-end;
    margin-left: auto;
    border-bottom-left-radius: 4px;
}

.bot-message {
    background-color: #2a2a2a;
    color: var(--white);
    align-self: flex-start;
    margin-right: auto;
    border-bottom-right-radius: 4px;
    border: 1px solid var(--blue-royal);
}

.bot-message strong {
    color: var(--blue-royal);
    display: block;
    margin-bottom: 5px;
    font-size: 1.1em;
}

.message-time {
    display:block;
    font-size:0.7em;
    color:#ccc;
    margin-top:5px;
    text-align:left;
}

.chat-input {
    display: flex;
    padding: 10px;
    background-color: var(--input-bg);
}

.chat-input input[type="text"] {
    flex-grow: 1;
    padding: 12px;
    border-radius: 20px;
    border: none;
    background-color: #333;
    color: white;
    margin-left: 10px;
}

.chat-input button {
    background-color: var(--blue-royal);
    border: none;
    color: white;
    padding: 12px 18px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.1em;
    flex-shrink: 0;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ù… Ø£ÙÙ‚ÙŠØ© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø³Ø­Ø¨ */
.quick-replies {
    display: flex;
    overflow-x: auto;
    gap: 10px;
    padding: 10px;
    background-color: #2a2a2a;
    border-top: 1px solid #444;
}

.quick-reply-btn {
    flex: 0 0 auto;
    background-color: var(--card-bg);
    color: var(--gold);
    border: 1px solid var(--gold);
    padding: 10px 18px;
    border-radius: 20px;
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 0.9em;
    white-space: nowrap;
}

.quick-reply-btn:hover {
    background-color: var(--gold);
    color: var(--dark-bg);
}

</style>
</head>
<body>

<div class="chat-container">
    <div class="chat-header">
        <button id="exitButton" onclick="leaveChat()">âœ–ï¸</button>
        <span>ğŸ¤– Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø³ÙŠØ§Ø­ÙŠ</span>
    </div>

    <div id="chatMessages" class="chat-messages">
        <div class="message bot-message">
            <strong>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!</strong>
            <p>ÙŠÙ…ÙƒÙ†Ùƒ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„Ùƒ Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ø±ÙŠØ¹Ø© Ù„Ù…Ø¹Ø±ÙØ© ÙƒÙŠÙÙŠØ© Ø­Ø¬Ø² Ø³Ø§Ø¦Ù‚ØŒ Ù…Ø±Ø´Ø¯ Ø£Ùˆ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³ÙŠØ§Ø­ÙŠØ© Ù…ÙØµÙ„Ø©.</p>
            <span class="message-time">Ø§Ù„Ø¢Ù†</span>
        </div>
    </div>

    <div id="quickReplies" class="quick-replies"></div>

    <div class="chat-input">
        <input type="text" id="messageInput" placeholder="Ø§Ø³Ø£Ù„ Ø§Ù„Ø¨ÙˆØª Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...">
        <button onclick="sendMessage()">â–¶ï¸</button>
    </div>
</div>

<script>
const chatMessagesDiv = document.getElementById('chatMessages');
const input = document.getElementById('messageInput');
const quickRepliesDiv = document.getElementById('quickReplies');

// Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
const appQuestions = [
    "ÙƒÙŠÙ Ø£Ø­Ø¬Ø² Ø³Ø§Ø¦Ù‚ØŸ",
    "ÙƒÙŠÙ Ø£Ø­Ø¬Ø² Ù…Ø±Ø´Ø¯ Ø³ÙŠØ§Ø­ÙŠØŸ",
    "ÙƒÙŠÙ Ø£Ø¨Ù„Øº Ø¹Ù† Ø´ÙƒÙˆÙ‰ØŸ",
    "ÙƒÙŠÙ Ø£Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ØŸ"
];

// Ø£Ù‡Ù… Ø§Ù„Ù…Ø¹Ø§Ù„Ù… Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ© Ø¨Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª
const landmarks = [
    "Ø¨Ø±Ø¬ Ø®Ù„ÙŠÙØ©",
    "Ø¯Ø¨ÙŠ Ù…ÙˆÙ„",
    "Ù†Ø§ÙÙˆØ±Ø© Ø¯Ø¨ÙŠ",
    "Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø´ÙŠØ® Ø²Ø§ÙŠØ¯",
    "Ù…ØªØ­Ù Ø§Ù„Ù„ÙˆÙØ± Ø£Ø¨ÙˆØ¸Ø¨ÙŠ",
    "Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ù„Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª",
    "Ø¬Ø²ÙŠØ±Ø© ÙŠØ§Ø³",
    "Ø­Ø¯ÙŠÙ‚Ø© ÙˆØ§ÙŠÙ„Ø¯ ÙˆØ§Ø¯ÙŠ",
    "Ø³ÙˆÙ‚ Ø§Ù„Ø°Ù‡Ø¨ Ø¯Ø¨ÙŠ"
];

// Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ù…
function populateQuickReplies() {
    quickRepliesDiv.innerHTML = '';
    [...appQuestions, ...landmarks].forEach(text => {
        const btn = document.createElement('button');
        btn.className = 'quick-reply-btn';
        btn.textContent = text;
        btn.onclick = () => handleQuickReply(text);
        quickRepliesDiv.appendChild(btn);
    });
}

// Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙˆØ³Ø¹Ø© Ù…Ù† ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§
async function fetchWikipediaSummary(query) {
    try {
        const response = await fetch(`https://ar.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
        const data = await response.json();
        if (data.extract) return data.extract;
        else return "Ø¹Ø°Ø±Ù‹Ø§ØŒ Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙˆØ³Ø¹Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„.";
    } catch(err) {
        return "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† ÙˆÙŠÙƒÙŠØ¨ÙŠØ¯ÙŠØ§.";
    }
}

// Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø®ØªØµØ±Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
function appResponse(message) {
    const lowerMsg = message.toLowerCase();
    if (lowerMsg.includes('Ø­Ø¬Ø² Ø³Ø§Ø¦Ù‚')) return 'Ù„Ø­Ø¬Ø² Ø³Ø§Ø¦Ù‚: Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ø®ØªØ± "Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙ†Ù‚Ù„ (Ø³Ø§Ø¦Ù‚ÙŠÙ†)".';
    if (lowerMsg.includes('Ø­Ø¬Ø² Ù…Ø±Ø´Ø¯')) return 'Ù„Ø­Ø¬Ø² Ù…Ø±Ø´Ø¯: Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ø®ØªØ± "Ø§Ù„Ù…Ø±Ø´Ø¯ÙŠÙ† Ø§Ù„Ø³ÙŠØ§Ø­ÙŠÙŠÙ†".';
    if (lowerMsg.includes('Ø´ÙƒÙˆÙ‰')) return 'Ù„Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø´ÙƒÙˆÙ‰: Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø´ÙƒÙˆÙ‰ / Ø§Ù‚ØªØ±Ø§Ø­" ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.';
    if (lowerMsg.includes('ÙƒÙŠÙ Ø£Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬')) return 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù„Ø­Ø¬Ø² Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†ØŒ Ø§Ù„Ù…Ø±Ø´Ø¯ÙŠÙ†ØŒ ØªØµÙØ­ Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ù…ØŒ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰.';
    return null;
}

// Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
function addMessage(sender, text) {
    const time = new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
    const messageDiv = document.createElement('div');
    messageDiv.className = 'message ' + (sender==='user'?'user-message':'bot-message');
    let content = '';
    if (sender==='bot') content += '<strong>ğŸ¤– Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø³ÙŠØ§Ø­ÙŠ</strong>';
    content += `<p style="white-space: pre-wrap;">${text}</p><span class="message-time">${time}</span>`;
    messageDiv.innerHTML = content;
    chatMessagesDiv.appendChild(messageDiv);
    chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
}

// Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
function handleQuickReply(question) {
    addMessage('user', question);
    input.value = '';
    setTimeout(() => sendBotMessage(question), 300);
}

// Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
function sendMessage() {
    const userMessage = input.value.trim();
    if (!userMessage) return;
    addMessage('user', userMessage);
    input.value = '';
    setTimeout(() => sendBotMessage(userMessage), 300);
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ Ù…Ù† Ø§Ù„Ø¨ÙˆØª
async function sendBotMessage(message) {
    const appResp = appResponse(message);
    if (appResp) {
        addMessage('bot', appResp);
    } else {
        const wikiText = await fetchWikipediaSummary(message);
        addMessage('bot', wikiText);
    }
}

// Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø´Ø§Øª
function leaveChat() { window.location.href = 'main_services.html'; }

document.getElementById('messageInput').addEventListener('keypress', e => {
    if (e.key==='Enter') sendMessage();
});

document.addEventListener('DOMContentLoaded', () => { populateQuickReplies(); });
</script>

</body>
</html>
